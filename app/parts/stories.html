
<ol class="breadcrumb">
    <li class="active"><i class="fa fa-book"></i> Stories</li>
</ol>

<uib-tabset>
    <uib-tab heading="Story Library">
        <div class="visible-md-block visible-lg-block"> <!-- Desktop/Tablet display -->
            <div class="container-fluid">
                <div class="table-responsive">
                    <table class="table table-striped table-hover table-condensed table-fixedheader">
                        <thead>
                            <tr>
                                <th ng-click="sortBy='title';sortReverse=!sortReverse">
                                    Title
                                    <span ng-show="sortBy == 'title' && !sortReverse" class="fa fa-caret-down"></span>
                                    <span ng-show="sortBy == 'title' && sortReverse" class="fa fa-caret-up"></span>
                                </th>
                                <th ng-click="sortBy='words';sortReverse=!sortReverse">
                                    Words
                                    <span ng-show="sortBy == 'words' && !sortReverse" class="fa fa-caret-down"></span>
                                    <span ng-show="sortBy == 'words' && sortReverse" class="fa fa-caret-up"></span>
                                </th>
                                <th ng-click="sortBy='genre';sortReverse=!sortReverse">
                                    Primary genre
                                    <span ng-show="sortBy == 'genre' && !sortReverse" class="fa fa-caret-down"></span>
                                    <span ng-show="sortBy == 'genre' && sortReverse" class="fa fa-caret-up"></span>
                                </th>
                                <th ng-click="sortBy='status';sortReverse=!sortReverse">
                                    Status
                                    <span ng-show="sortBy == 'status' && !sortReverse" class="fa fa-caret-down"></span>
                                    <span ng-show="sortBy == 'status' && sortReverse" class="fa fa-caret-up"></span>
                                <th>Comments</th>
                            </tr>
                            <tr>
                                <td class="bg-info">
                                    <span class="glyphicon glyphicon-search" ng-show="showFilters != true" ng-click="showFilters = true"></span>
                                    <span class="glyphicon glyphicon-remove" ng-show="showFilters == true" ng-click="showFilters = false;search = []"></span>
                                    <span ng-show="showFilters != true" ng-click="showFilters = true" class="small search">Search</span>
                                    <span ng-show="showFilters == true" ng-click="showFilters = false;search = []" class="small search">Search</span>
                                </td>
                            </tr>
                            <tr ng-show="showFilters == true" class="bg-info">
                                <th><input class="form-control" ng-model="search.title" /></th>
                                <th><select class="form-control" ng-model="search.words" ng-options="words.name as words.id for words in storyLengthList"><option value="">---</option></select></th>
                                <th><select class="form-control" ng-model="search.genre" ng-options="genre.name as genre.id for genre in genreList"><option value="">---</option></select></th>
                                <th><select class="form-control" ng-model="search.status" ng-options="status.name as status.id for status in statusList"><option value="">---</option></select></th>
                                <th><input class="form-control" ng-model="search.comments" /></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-model="stories" ng-repeat="story in stories | orderBy:sortBy:sortReverse | StoryFilter:search" ng-class="subStatus(story.submitted, story.sold, story.status)">
                                <td>
                                    <div class="btn-group btn-group-justified" uib-dropdown>
                                        <a id="{{'split-button-' + story.storyId}}" ng-href="/#/stories/{{story.storyId}}" class="btn btn-default form-control-static">{{story.title}}</a>
                                        <button type="button" class="btn btn-default" uib-dropdown-toggle>
                                            <span class="caret"></span>
                                            <span class="sr-only">Split button!</span>
                                        </button>
                                        <ul class="uib-dropdown-menu" role="menu" aria-labelledby="split-button">
                                            <li role="menuitem"><a ng-href="/#/stories/{{story.storyId}}/submissions">Submissions</a></li>
                                            <li role="menuitem"><a ng-href="/#/stories/{{story.storyId}}/readers">Readers</a></li>
                                        </ul>
                                    </div>
                                </td>
                                <td>
                                    <input ng-model="story.words" ng-change="$parent.updateStory(story)" class="form-control" type="number" />
                                </td>
                                <td>
                                    <select class="form-control" ng-change="$parent.updateStory(story)" ng-model="story.genre" ng-options="genre.name as genre.id for genre in genreList"></select>
                                </td>
                                <td>
                                    <select class="form-control" ng-change="$parent.updateStory(story)" ng-model="story.status" ng-options="status.name as status.id for status in statusList"></select>
                                </td>
                                <td>
                                    <input ng-change="$parent.updateStory(story)" ng-model="story.comments" class="form-control" type="text" />
                                </td>
                            </tr>
                            <tr ng-show="stories.length == 0"><td><p class="bg-info">No stories in this library yet.</p></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="well">
                <button type="button" class="btn btn-primary btn-lg" ng-click="newStory()">
                    New story
                </button>
                <a class="btn btn-default btn-lg" href="/backup.json">Download</a>
                <div class="pull-right container-fluid">
                    <div class="row">
                        <div class="col-sm-3">
                            <span class="label label-success small" style="display: block; width:50px;">Green</span>
                        </div>
                        <div class="col-sm-8">
                            <span class="small">Currently at a market
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3">
                            <span class="label label-danger small" style="display: block; width:50px">Red</span>
                        </div>
                        <div class="col-sm-8">
                            <span class="small">Ready to be submitted
                        </div>
                    </div>
                </div>
                <div class="pull-right container-fluid">
                    <div class="row">
                        <div class="col-sm-4">
                            <span class="label label-info small" style="display: block; width:50px;">Blue</span>
                        </div>
                        <div class="col-sm-8">
                            <span class="small">Previously sold
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">
                            <span class="label label-default small" style="display: block; width:50px">Gray</span>
                        </div>
                        <div class="col-sm-8">
                            <span class="small">Not finished
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="visible-sm-block visible-xs-block">
            <uib-accordion>
                <uib-accordion-group ng-model="stories" ng-repeat="story in stories | orderBy:sortBy:sortReverse | StoryFilter:search" heading="{{story.title}}" is-open="mobile.isOpen" ng-click="mobile.isOpen = !mobile.isOpen" panel-class="panel-{{subStatus(story.submitted, story.sold, story.status)}}">
                    <div class="list-group">
                        <a class="list-group-item" ng-href="/#/stories/{{story.storyId}}">
                            Story Details
                        </a>
                        <a class="list-group-item" ng-href="/#/stories/{{story.storyId}}/submissions">
                            Submissions
                        </a>
                        <a class="list-group-item" ng-href="/#/stories/{{story.storyId}}/readers">
                            Readers
                        </a>
                    </div>
                </uib-accordion-group>
            </uib-accordion>
            <div class="well">
                <button type="button" class="btn btn-primary btn-sm" ng-click="newStory()">
                    New story
                </button>
                <a class="btn btn-default btn-sm" href="/backup.json">Download</a>
            </div>
        </div>
    </uib-tab>
    <uib-tab heading="Statistics">
        <div class="panel panel-default">
            <div class="panel-body">
                <pre>
Total number of stories in library: {{stories.length}}
-----------------------------------


By genre                  By status
--------                  ---------
Adventure       : {{ ( stories | filter: { genre: "Adventure" } ).length }}       Unfinished  : {{ ( stories | filter: { status: "Unfinished" } ).length }}
Crime/Detective : {{ ( stories | filter: { genre: "Crime/Detective " } ).length }}       First Draft : {{ ( stories | filter: { status: "First Draft" } ).length }}
Fantasy         : {{ ( stories | filter: { genre: "Fantasy" } ).length }}       Revisions   : {{ ( stories | filter: { status: "Revisions" } ).length }}
Horror          : {{ ( stories | filter: { genre: "Horror" } ).length }}       Trunk       : {{ ( stories | filter: { status: "Trunk" } ).length }}
Literary        : {{ ( stories | filter: { genre: "Literary" } ).length }}       Finished    : {{ ( stories | filter: { status: "Finished" } ).length }}
Magical Realism : {{ ( stories | filter: { genre: "Magical Realism" } ).length }}
Mainstream      : {{ ( stories | filter: { genre: "Mainstream" } ).length }}
Mystery         : {{ ( stories | filter: { genre: "Mystery" } ).length }}
Sci-Fi          : {{ ( stories | filter: { genre: "Sci-Fi" } ).length }}
Slipstream      : {{ ( stories | filter: { genre: "Slipstream" } ).length }}
Surreal         : {{ ( stories | filter: { genre: "Surreal" } ).length }}
Thriller        : {{ ( stories | filter: { genre: "Thriller" } ).length }}
Western         : {{ ( stories | filter: { genre: "Western" } ).length }}

                </pre>
            </div>
        </div>
    </uib-tab>
</uib-tabset>